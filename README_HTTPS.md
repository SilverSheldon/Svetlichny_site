# Настройка HTTPS и домена infobez

Этот документ описывает настройку сайта для работы с HTTPS и доменным именем `infobez` вместо IP-адреса.

## Шаг 1: Генерация SSL сертификата

### Вариант A: Использование Python скрипта (требуется OpenSSL)

1. Установите OpenSSL:
   - **Windows**: Скачайте с https://slproweb.com/products/Win32OpenSSL.html
   - Или через Chocolatey: `choco install openssl`
   - Или через Git Bash (устанавливается вместе с Git)

2. Убедитесь, что OpenSSL доступен в PATH:
   ```powershell
   openssl version
   ```

3. Запустите генерацию сертификата:
   ```bash
   python generate_cert.py
   ```

### Вариант B: Использование PowerShell скрипта (Windows)

```powershell
.\generate_cert.ps1
```

**Примечание**: PowerShell создаст сертификат в формате PFX. Для Flask нужны файлы в формате PEM. Используйте Python скрипт или установите OpenSSL.

### Вариант C: Ручное создание через OpenSSL

```bash
mkdir ssl
cd ssl

openssl req -x509 -newkey rsa:4096 -nodes -out cert.pem -keyout key.pem -days 365 -subj "/C=RU/ST=State/L=City/O=Organization/CN=infobez"
```

После выполнения любого варианта в директории `ssl/` должны появиться файлы:
- `cert.pem` - сертификат
- `key.pem` - приватный ключ

## Шаг 2: Настройка hosts файла

Для работы с доменом `infobez` в локальной сети необходимо добавить запись в hosts файл.

### Windows

1. Откройте файл hosts с правами администратора:
   ```
   C:\Windows\System32\drivers\etc\hosts
   ```
   
   Или через PowerShell (как администратор):
   ```powershell
   notepad C:\Windows\System32\drivers\etc\hosts
   ```

2. Добавьте в конец файла:
   ```
   127.0.0.1    infobez
   ```

3. Сохраните файл

4. Очистите DNS кэш:
   ```powershell
   ipconfig /flushdns
   ```

### Linux / macOS

1. Откройте файл hosts:
   ```bash
   sudo nano /etc/hosts
   ```

2. Добавьте строку:
   ```
   127.0.0.1    infobez
   ```

3. Сохраните файл (Ctrl+X, затем Y, затем Enter для nano)

## Шаг 3: Запуск приложения

После настройки сертификатов и hosts файла:

```bash
python app.py
```

Приложение запустится с HTTPS по адресу:
- **HTTPS**: https://infobez (порт 443)
- **HTTP** (если сертификаты не найдены): http://infobez (порт 80)

**Важно**: Для портов 443 (HTTPS) и 80 (HTTP) требуются права администратора/root!

## Шаг 4: Доступ к сайту

1. Откройте браузер
2. Перейдите на: `https://infobez`

### Предупреждение о безопасности

Браузер покажет предупреждение о самоподписанном сертификате. Это нормально для локальной разработки:

- **Chrome/Edge**: Нажмите "Дополнительно" → "Перейти на infobez (небезопасно)"
- **Firefox**: Нажмите "Дополнительно" → "Принять риск и продолжить"
- **Safari**: Нажмите "Показать детали" → "посетить этот веб-сайт"

## Важные замечания

### Для продакшена

Самоподписанные сертификаты подходят только для разработки. Для продакшена используйте:

1. **Let's Encrypt** - бесплатные SSL сертификаты
2. **Cloudflare** - бесплатный SSL прокси
3. **Коммерческие сертификаты** от доверенных центров сертификации

### Порт по умолчанию

По умолчанию приложение использует:
- **Порт 443** для HTTPS (стандартный порт)
- **Порт 80** для HTTP (стандартный порт)

Для этих портов требуются права администратора/root. Приложение автоматически определит наличие прав и выдаст соответствующее сообщение при ошибке.

## Устранение проблем

### Сертификаты не найдены

- Убедитесь, что файлы `ssl/cert.pem` и `ssl/key.pem` существуют
- Проверьте права доступа к файлам

### Домен не разрешается

- Проверьте, что запись в hosts файле корректна
- Очистите DNS кэш: `ipconfig /flushdns` (Windows)
- Перезапустите браузер

### Ошибка подключения

- Проверьте, что приложение запущено
- Убедитесь, что порт 5000 не занят другим приложением
- Проверьте настройки файрвола

## Безопасность

⚠️ **ВАЖНО**: Самоподписанные сертификаты предназначены только для локальной разработки!

- Не используйте их в продакшене
- Не передавайте приватные ключи
- Для реальных проектов используйте сертификаты от доверенных CA

